import base64
code="aW1wb3J0IHB5bW9uZ28NCmltcG9ydCByYW5kb20NCmltcG9ydCByZQ0KaW1wb3J0IHN0cmluZw0KaW1wb3J0IHN5cw0KaW1wb3J0IGdldG9wdA0KaW1wb3J0IHBwcmludA0KDQojIENvcHlyaWdodCAyMDEyDQojIDEwZ2VuLCBJbmMuDQojIEF1dGhvcjogQW5kcmV3IEVybGljaHNvbiAgIGFqZUAxMGdlbi5jb20NCiMNCiMgSWYgeW91IGFyZSBhIHN0dWRlbnQgYW5kIHJlYWRpbmcgdGhpcyBjb2RlLCB0dXJuIGJhY2sgbm93LCBiZWZvcmUNCiMgdGhlIE1vbmdvREIgZ29kcyBzbWl0ZSB5b3UuDQoNCmNvbm5lY3Rpb24gPSBOb25lDQpkYiA9IE5vbmUNCndlYmhvc3QgPSAibG9jYWxob3N0OjgwODIiDQptb25nb3N0ciA9ICJtb25nb2RiOi8vbG9jYWxob3N0OjI3MDE3Ig0KZGJfbmFtZSA9ICJibG9nIg0KDQojIHRoaXMgc2NyaXB0IHdpbGwgY2hlY2sgdGhhdCBob21ld29yayA0LjMNCg0KIyBjb21tYW5kIGxpbmUgYXJnIHBhcnNpbmcgdG8gbWFrZSBmb2xrcyBoYXBweSB3aG8gd2FudCB0byBydW4gYXQgbW9uZ29sYWJzIG9yIG1vbmdvaHENCiMgdGhpcyBmdW5jdGlvbnMgdXNlcyBnbG9iYWwgdmFycyB0byBjb21tdW5pY2F0ZS4gZm9yZ2l2ZSBtZS4NCmRlZiBhcmdfcGFyc2luZyhhcmd2KToNCg0KICAgIGdsb2JhbCB3ZWJob3N0DQogICAgZ2xvYmFsIG1vbmdvc3RyDQogICAgZ2xvYmFsIGRiX25hbWUNCg0KICAgIHRyeToNCiAgICAgICAgb3B0cywgYXJncyA9IGdldG9wdC5nZXRvcHQoYXJndiwgIi1wOi1tOi1kOiIpDQogICAgZXhjZXB0IGdldG9wdC5HZXRvcHRFcnJvcjoNCiAgICAgICAgcHJpbnQoInVzYWdlIHZhbGlkYXRlLnB5IC1wIHdlYmhvc3QgLW0gbW9uZ29Db25uZWN0U3RyaW5nIC1kIGRhdGFiYXNlTmFtZSIpDQogICAgICAgIHByaW50KCJcdG1vbmdvQ29ubmVjdGlvblN0cmluZyBkZWZhdWx0IHRvIHswfSIuZm9ybWF0KG1vbmdvc3RyKSkNCiAgICAgICAgcHJpbnQoIlx0ZGF0YWJhc2VOYW1lIGRlZmF1bHRzIHRvIHswfSIuZm9ybWF0KGRiX25hbWUpKQ0KICAgICAgICBzeXMuZXhpdCgyKQ0KICAgIGZvciBvcHQsIGFyZyBpbiBvcHRzOg0KICAgICAgICBpZiAob3B0ID09ICctaCcpOg0KICAgICAgICAgICAgcHJpbnQoInVzYWdlIHZhbGlkYXRlLnB5IC1tIG1vbmdvQ29ubmVjdFN0cmluZyAtZCBkYXRhYmFzZU5hbWUiKQ0KICAgICAgICAgICAgc3lzLmV4aXQoMikNCiAgICAgICAgZWxpZiBvcHQgaW4gKCItbSIpOg0KICAgICAgICAgICAgbW9uZ29zdHIgPSBhcmcNCiAgICAgICAgICAgIHByaW50KCJPdmVycmlkaW5nIE1vbmdvREIgY29ubmVjdGlvbiBzdHJpbmcgdG8gYmUgIiwgbW9uZ29zdHIpDQogICAgICAgIGVsaWYgb3B0IGluICgiLWQiKToNCiAgICAgICAgICAgIGRiX25hbWUgPSBhcmcNCiAgICAgICAgICAgIHByaW50KCJPdmVycmlkaW5nIE1vbmdvREIgZGF0YWJhc2UgdG8gYmUgIiwgZGJfbmFtZSkNCg0KIyBjaGVjayB0byBzZWUgaWYgdGhleSBsb2FkZWQgdGhlIGRhdGEgc2V0DQpkZWYgY2hlY2tfZm9yX2RhdGFfaW50ZWdyaXR5KCk6DQoNCiAgICBwb3N0cyA9IGRiLnBvc3RzDQogICAgdHJ5Og0KICAgICAgICBjb3VudCA9IHBvc3RzLmNvdW50KCkNCiAgICBleGNlcHQ6DQogICAgICAgIHByaW50KCJjYW4ndCBxdWVyeSBNb25nb0RCLi5pcyBpdCBydW5uaW5nPyIpDQogICAgICAgIHJhaXNlDQogICAgICAgIHJldHVybiBGYWxzZQ0KDQogICAgaWYgKGNvdW50ICE9IDEwMDApOg0KICAgICAgICBwcmludCgiVGhlcmUgYXJlIHN1cHBvc2VkIHRvIGJlIDEwMDAgZG9jdW1lbnRzLiB5b3UgaGF2ZSAiLCBjb3VudCkNCiAgICAgICAgcmV0dXJuIEZhbHNlDQoNCiAgICAjIGZpbmQgdGhlIG1vc3QgcG9wdWxhciB0YWdzDQogICAgdHJ5Og0KDQogICAgICAgIHJlc3VsdCA9IGRiLnBvc3RzLmFnZ3JlZ2F0ZShbeyckcHJvamVjdCc6eyd0YWdzJzoxfX0sIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsnJHVud2luZCc6JyR0YWdzJ30sIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsnJGdyb3VwJzp7J19pZCc6ICckdGFncycsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY291bnQnOnsnJHN1bSc6MX19fSwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyckc29ydCc6eydjb3VudCc6LTF9fSwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyckbGltaXQnOjEwfV0pDQogICAgZXhjZXB0Og0KICAgICAgICBwcmludCgiY2FuJ3QgcXVlcnkgTW9uZ29EQi4uaXMgaXQgcnVubmluZz8iKQ0KICAgICAgICByYWlzZQ0KICAgICAgICByZXR1cm4gRmFsc2UNCiAgICAgICAgDQogICAgZm91bmQgPSBGYWxzZQ0KICAgIGZvciBpdGVtIGluIHJlc3VsdDoNCiAgICAgICAgaWYgKGl0ZW1bJ2NvdW50J10gPT0gMTMgYW5kIA0KICAgICAgICAgICAgaXRlbVsnX2lkJ10gPT0gInNwaHlueCIpOg0KICAgICAgICAgICAgZm91bmQgPSBUcnVlDQoNCiAgICBpZiBub3QgZm91bmQ6DQogICAgICAgIHByaW50KCJUaGUgZGF0YXNldCBpcyBub3QgcHJvcGVybHkgbG9hZGVkLiBUaGUgZGlzdHJpYnV0aW9uIG9mIHBvc3QgdGFncyBpcyB3cm9uZy4iKQ0KICAgICAgICByZXR1cm4gRmFsc2UNCg0KICAgIHByaW50KCJEYXRhIGxvb2tzIGxpa2UgaXQgaXMgcHJvcGVybHkgbG9hZGVkIGludG8gdGhlIHBvc3RzIGNvbGxlY3Rpb24iKQ0KDQogICAgcmV0dXJuIFRydWUNCiAgICANCg0KZGVmIGNoZWNrX2Zvcl9mYXN0X2Jsb2dfaG9tZV9wYWdlKCk6DQoNCiAgICBwb3N0cyA9IGRiLnBvc3RzDQoNCiAgICB0cnk6DQogICAgICAgIGV4cGxhaW4gPSBwb3N0cy5maW5kKCkuc29ydCgnZGF0ZScsIGRpcmVjdGlvbj0tMSkubGltaXQoMTApLmV4cGxhaW4oKQ0KICAgIGV4Y2VwdDoNCiAgICAgICAgcHJpbnQoImNhbid0IHF1ZXJ5IE1vbmdvREIuLmlzIGl0IHJ1bm5pbmc/IikNCiAgICAgICAgcmFpc2UNCiAgICAgICAgcmV0dXJuIEZhbHNlDQoNCiAgICBpZiAoZXhwbGFpblsnZXhlY3V0aW9uU3RhdHMnXVsndG90YWxEb2NzRXhhbWluZWQnXSA+IDEwKToNCiAgICAgICAgcHJpbnQoIlNvcnJ5LCBleGVjdXRpbmcgdGhlIHF1ZXJ5IHRvIGRpc3BsYXkgdGhlIGhvbWUgcGFnZSBpcyB0b28gc2xvdy4gIikNCiAgICAgICAgcHJpbnQoIldlIHNob3VsZCBiZSBzY2FubmluZyBubyBtb3JlIHRoYW4gMTAgZG9jdW1lbnRzLiBZb3Ugc2Nhbm5lZCIsIGV4cGxhaW5bJ2V4ZWN1dGlvblN0YXRzJ11bJ3RvdGFsRG9jc0V4YW1pbmVkJ10pDQogICAgICAgIHByaW50KCJoZXJlIGlzIHRoZSBvdXRwdXQgZnJvbSBleHBsYWluIikNCg0KICAgICAgICBwcCA9IHBwcmludC5QcmV0dHlQcmludGVyKGRlcHRoPTYpDQogICAgICAgIHBwLnBwcmludChleHBsYWluKQ0KICAgICAgICByZXR1cm4gRmFsc2UNCiAgICANCiAgICBwcmludCgiSG9tZSBwYWdlIGlzIHN1cGVyIGZhc3QuIE5pY2Ugam9iLlxuIikNCiAgICByZXR1cm4gVHJ1ZQ0KDQpkZWYgZ2V0X3RoZV9taWRkbGVfcGVybWFsaW5rKCk6DQogICAgcG9zdHMgPSBkYi5wb3N0cw0KICAgIHRyeToNCiAgICAgICAgYyA9IHBvc3RzLmZpbmQoKS5za2lwKDUwMCkubGltaXQoMSkNCiAgICAgICAgZm9yIGRvYyBpbiBjOg0KICAgICAgICAgICAgcGVybWFsaW5rID0gZG9jWydwZXJtYWxpbmsnXQ0KICAgICAgICAgICAgcmV0dXJuIHBlcm1hbGluaw0KICAgIGV4Y2VwdDoNCiAgICAgICAgcHJpbnQoImNhbid0IHF1ZXJ5IE1vbmdvREIuLmlzIGl0IHJ1bm5pbmc/IikNCiAgICAgICAgcmFpc2UNCiAgICByZXR1cm4gIiINCg0KZGVmIGNoZWNrX2Zvcl9mYXN0X2Jsb2dfZW50cnlfcGFnZSgpOg0KICAgIA0KICAgIHBvc3RzID0gZGIucG9zdHMNCg0KICAgIHBlcm1hbGluayA9IGdldF90aGVfbWlkZGxlX3Blcm1hbGluaygpDQogICAgdHJ5Og0KICAgICAgICBleHBsYWluID0gcG9zdHMuZmluZCh7J3Blcm1hbGluayc6cGVybWFsaW5rfSkuZXhwbGFpbigpDQogICAgZXhjZXB0Og0KICAgICAgICBwcmludCgiY2FuJ3QgcXVlcnkgTW9uZ29EQi4uaXMgaXQgcnVubmluZz8iKQ0KICAgICAgICByYWlzZQ0KICAgICAgICByZXR1cm4gRmFsc2UNCg0KICAgIGlmIChleHBsYWluWydleGVjdXRpb25TdGF0cyddWyd0b3RhbERvY3NFeGFtaW5lZCddID4gMSk6DQogICAgICAgIHByaW50KCJTb3JyeSwgZXhlY3V0aW5nIHRoZSBxdWVyeSB0byByZXRyaWV2ZSBhIHBvc3QgYnkgcGVybWFsaW5rIGlzIHRvbyBzbG93ICIpDQogICAgICAgIHByaW50KCJXZSBzaG91bGQgYmUgc2Nhbm5pbmcgbm8gbW9yZSB0aGFuIDEgZG9jdW1lbnRzLiBZb3Ugc2Nhbm5lZCIsIGV4cGxhaW5bJ2V4ZWN1dGlvblN0YXRzJ11bJ3RvdGFsRG9jc0V4YW1pbmVkJ10pDQogICAgICAgIHByaW50KCJoZXJlIGlzIHRoZSBvdXRwdXQgZnJvbSBleHBsYWluIikNCg0KICAgICAgICBwcCA9IHBwcmludC5QcmV0dHlQcmludGVyKGRlcHRoPTYpDQogICAgICAgIHBwLnBwcmludChleHBsYWluKQ0KICAgICAgICByZXR1cm4gRmFsc2UNCiAgICANCiAgICBwcmludCgiQmxvZyByZXRyaWV2YWwgYnkgcGVybWFsaW5rIGlzIHN1cGVyIGZhc3QuIE5pY2Ugam9iLlxuIikNCiAgICByZXR1cm4gVHJ1ZQ0KDQoNCmRlZiBjaGVja19mb3JfZmFzdF9wb3N0c19ieV90YWdfcGFnZSgpOg0KICAgIHBvc3RzID0gZGIucG9zdHMNCg0KICAgIHRhZyA9ICJzcGh5bngiDQogICAgdHJ5Og0KICAgICAgICBleHBsYWluID0gcG9zdHMuZmluZCh7J3RhZ3MnOnRhZ30pLnNvcnQoJ2RhdGUnLCBkaXJlY3Rpb249LTEpLmxpbWl0KDEwKS5leHBsYWluKCkNCiAgICBleGNlcHQ6DQogICAgICAgIHByaW50KCJjYW4ndCBxdWVyeSBNb25nb0RCLi5pcyBpdCBydW5uaW5nPyIpDQogICAgICAgIHJhaXNlDQogICAgICAgIHJldHVybiBGYWxzZQ0KDQogICAgaWYgKGV4cGxhaW5bJ2V4ZWN1dGlvblN0YXRzJ11bJ3RvdGFsRG9jc0V4YW1pbmVkJ10gPiAxMCk6DQogICAgICAgIHByaW50KCJTb3JyeSwgZXhlY3V0aW5nIHRoZSBxdWVyeSB0byByZXRyaWV2ZSBwb3N0cyBieSB0YWcgaXMgdG9vIHNsb3cuIikNCiAgICAgICAgcHJpbnQoIldlIHNob3VsZCBiZSBzY2FubmluZyBubyBtb3JlIHRoYW4gMTAgZG9jdW1lbnRzLiBZb3Ugc2Nhbm5lZCIsIGV4cGxhaW5bJ2V4ZWN1dGlvblN0YXRzJ11bJ3RvdGFsRG9jc0V4YW1pbmVkJ10pDQogICAgICAgIHByaW50KCJoZXJlIGlzIHRoZSBvdXRwdXQgZnJvbSBleHBsYWluIikNCg0KICAgICAgICBwcCA9IHBwcmludC5QcmV0dHlQcmludGVyKGRlcHRoPTYpDQogICAgICAgIHBwLnBwcmludChleHBsYWluKQ0KICAgICAgICByZXR1cm4gRmFsc2UNCiAgICANCiAgICBwcmludCgiQmxvZyByZXRyaWV2YWwgYnkgdGFnIGlzIHN1cGVyIGZhc3QuIE5pY2Ugam9iLlxuIikNCiAgICByZXR1cm4gVHJ1ZQ0KDQoNCiMgbWFpbiBzZWN0aW9uIG9mIHRoZSBjb2RlDQpkZWYgbWFpbihhcmd2KToNCiAgICAgICAgICAgIA0KICAgIGFyZ19wYXJzaW5nKGFyZ3YpDQogICAgZ2xvYmFsIGNvbm5lY3Rpb24NCiAgICBnbG9iYWwgZGINCg0KICAgIHByaW50KCJXZWxjb21lIHRvIHRoZSBIVyA0LjMgQ2hlY2tlci4gTXkgam9iIGlzIHRvIG1ha2Ugc3VyZSB5b3UgYWRkZWQgdGhlIGluZGV4ZXMiKQ0KICAgIHByaW50KCJ0aGF0IG1ha2UgdGhlIGJsb2cgZmFzdCBpbiB0aGUgZm9sbG93aW5nIHRocmVlIHNpdHVhdGlvbnMiKQ0KICAgIHByaW50KCJcdFdoZW4gc2hvd2luZyB0aGUgaG9tZSBwYWdlIikNCiAgICBwcmludCgiXHRXaGVuIGZldGNoaW5nIGEgcGFydGljdWxhciBwb3N0IikNCiAgICBwcmludCgiXHRXaGVuIHNob3dpbmcgYWxsIHBvc3RzIGZvciBhIHBhcnRpY3VsYXIgdGFnIikNCg0KICAgICMgY29ubmVjdCB0byB0aGUgZGIgKG1vbmdvc3RyIHdhcyBzZXQgaW4gYXJnX3BhcnNpbmcpDQogICAgdHJ5Og0KICAgICAgICBjb25uZWN0aW9uID0gcHltb25nby5Nb25nb0NsaWVudChtb25nb3N0cikNCiAgICAgICAgZGIgPSBjb25uZWN0aW9uW2RiX25hbWVdDQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOg0KICAgICAgICBwcmludCgiY2FuJ3QgY29ubmVjdCB0byBNb25nb0RCIHVzaW5nIiwgbW9uZ29zdHIsICIuIElzIGl0IHJ1bm5pbmc/IikNCiAgICAgICAgcHJpbnQoIkV4Y2VwdGlvbiB3YXMiLCBlKQ0KICAgICAgICBzeXMuZXhpdCgxKQ0KICAgICAgICANCiAgICBpZiAobm90IGNoZWNrX2Zvcl9kYXRhX2ludGVncml0eSgpKToNCiAgICAgICAgcHJpbnQoIlNvcnJ5LCB0aGUgZGF0YSBzZXQgaXMgbm90IGxvYWRlZCBjb3JyZWN0bHkgaW4gdGhlIHBvc3RzIGNvbGxlY3Rpb24iKQ0KICAgICAgICBzeXMuZXhpdCgxKQ0KDQogICAgaWYgKG5vdCBjaGVja19mb3JfZmFzdF9ibG9nX2hvbWVfcGFnZSgpKToNCiAgICAgICAgcHJpbnQoIlNvcnJ5LCB0aGUgcXVlcnkgdG8gZGlzcGxheSB0aGUgYmxvZyBob21lIHBhZ2UgaXMgdG9vIHNsb3cuIikNCiAgICAgICAgc3lzLmV4aXQoMSkNCg0KICAgIGlmIChub3QgY2hlY2tfZm9yX2Zhc3RfYmxvZ19lbnRyeV9wYWdlKCkpOg0KICAgICAgICBwcmludCgiU29ycnksIHRoZSBxdWVyeSB0byByZXRyaWV2ZSBhIGJsb2cgcG9zdCBieSBwZXJtYWxpbmsgaXMgdG9vIHNsb3cuIikNCiAgICAgICAgc3lzLmV4aXQoMSkNCg0KICAgIGlmIChub3QgY2hlY2tfZm9yX2Zhc3RfcG9zdHNfYnlfdGFnX3BhZ2UoKSk6DQogICAgICAgIHByaW50KCJTb3JyeSwgdGhlIHF1ZXJ5IHRvIHJldHJpZXZlIGFsbCBwb3N0cyB3aXRoIGEgY2VydGFpbiB0YWcgaXMgdG9vIHNsb3ciKQ0KICAgICAgICBzeXMuZXhpdCgxKQ0KICAgIA0KICAgICMgaWYgeW91IGFyZSByZWFkaW5nIHRoaXMgaW4gY2xlYXJ0ZXh0LCB5b3UgYXJlIHZpb2xhdGluZyB0aGUgaG9ub3IgY29kZS4NCiAgICAjIFlvdSBjYW4gc3RpbGwgcmVkZWVtIHlvdXJzZWxmLiBHZXQgaXQgd29ya2luZyBhbmQgZG9uJ3Qgc3VibWl0IHRoZSB2YWxpZGF0aW9uIGNvZGUgdW50aWwgeW91IGRvLg0KICAgICMgQWxsIGEgbWFuIGhhcyBhdCB0aGUgZW5kIG9mIHRoZSBkYXkgaXMgaGlzIHdvcmQuDQogICAgcHJpbnQoIlRlc3RzIFBhc3NlZCBmb3IgSFcgNC4zLiBZb3VyIEhXIDQuMyB2YWxpZGF0aW9uIGNvZGUgaXMgODkzamZuczI5ZjcyOGZuMjlmMjBmMiIpDQoNCg0KDQppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOg0KICAgIG1haW4oc3lzLmFyZ3ZbMTpdKQ=="
eval(compile(base64.b64decode(code), "<string>", 'exec'))
